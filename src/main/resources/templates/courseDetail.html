<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>
<!--顶部的导航条-->
<nav class="navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <img alt="Brand" src="/templates/images/logo.jpg"style="width: 60px;">
            <a class="navbar-brand active"id="showUserName" href="/home">
                <span class="glyphicon glyphicon-home"></span>
                首页</a>
        </div>
        <ul class="nav navbar-nav">
            <li id="username"><a href="login">请登录</a></li>
            <li ><a href="mine"><span class="glyphicon glyphicon-tree-deciduous"></span>我的</a></li>
            <li class="teaOnly"><a href='/contactStu'>教师与学生对话页面</a></li>
        </ul>
    </div>
</nav>
<h1 class="text-center">
    <span class="glyphicon glyphicon-tag" aria-hidden="true">课程标题</span>
</h1>
<br>
<br>
<h3 class="text-info text-center">课程详情</h3>
<br>
<br>
<!--课程详情列表-->
<dl class="dl-horizontal text-center">
    <div class="row">
        <button type="button" class="btn btn-success col-lg-offset-9 btn-lg"><a href="/contactTea/" id="contactTea">联系老师</a></button>
    </div>
    <dt>课程简介</dt>
    <dd id="introduction">Item 1</dd>
    <br>
    <dt>教师</dt>
    <dd id="teacherName">Item 2</dd>
    <br>
    <dt>教师简介</dt>
    <dd id="teacherProfile">llll</dd>
    <br>
    <dt>教师所在学校</dt>
    <dd id="school">dddd</dd>
    <br>
    <dt>参加学生数量</dt>
    <dd id="numberOfStudents">ddddd</dd>
</dl>
<!--显示该课程下的作业-->
<div class="row">
   <div class="panel panel-default col-lg-8 col-lg-offset-2">
   </div>
</div>
<script>
    var courseId=0;
    $(document).ready(function (){
        //判断并显示用户的登录信息
        $.ajax({
            url:"/loginOrNot",
            type:"get",
            success:function (data){
                if(data.name){
                    $("#showUserName").html("<span class=\"glyphicon glyphicon-home\"></span>首页/欢迎"+data.name);
                };
                if(data.identity=="teacher"){
                    alert("请打开教师与学生对话页面，以免错过学生的信息。");
                }else if(data.identity=="student"){
                    $(".teaOnly").hide();
                }
            }
        });
        //显示课程的详细信息
        $.ajax({
            url:"/courseDetail",
            type:"get",
            success:function (data){
                $("#introduction").html(data.introduction);
                $("#numberOfStudents").html(data.numberOfStudents);
                $("h1").children("span").html(data.name);
                $("#teacherName").html(data.teacherName);
                $("#teacherProfile").html(data.teacherProfile);
                $("#school").html(data.school);
                $("#contactTea").attr("href","/contactTea/" + data.teacherId);
                courseId=data.courseId;
                //显示所有的作业

                var data = {
                    courseId: courseId
                }
                $.ajax({
                    url: "/allAssignments",
                    data: data,
                    type: "post",
                    success: function (data) {
                        var start = 1;
                        var pannel = $(".panel-default");
                        for (var i = 0; i < data.length; i++) {
                            if (data[i].serialNumber == start) {
                                pannel.append("<div class=\"panel-heading\">" +
                                    "        <h3 class=\"panel-title\"\">第"+
                                    start+
                                    "次作业</h3>" +
                                    "    </div><div class=\"panel-body\">"
                                );
                                start++;
                            }
                            pannel.append("<p title=\"答案（仅可显示已过期的作业的）\" data-container=\"body\" data-toggle=\"popover\" data-placement=\"top\" data-content=\"" +
                                data[i].answer   +
                                "\">题目 "   +
                                data[i].name +
                                "</p>")
                        }
                        $("[data-toggle='popover']").popover();
                    }
                })
            }
        });
    });
</script>
</body>
</html>